{"version":3,"sources":["immediate.js","global.js","init.js"],"names":["window","JAY","immediate","init","document","querySelector","classList","add","global","methods","mobile","body","clientWidth","fixedHeader","imageLoad","bodyOffset","header","addEventListener","contains","getBoundingClientRect","top","Math","abs","height","remove","passive","images","querySelectorAll","load","capture","forEach","image","innerHeight","src","dataset","replace","clientHeight","ceil","devicePixelRatio","parentNode","tagName","imageZoom","length","removeEventListener","mask","getElementById","createElement","anchor","img","loading","setTimeout","naturalWidth","setAttribute","appendChild","e","preventDefault","figureGroup","figureIndex","children","indexOf","screenNav","escape","key","close","innerHTML","getAttribute","figure","index","target","href","insertBefore","append","getElementsByTagName","controller","action","view","onreadystatechange","readyState"],"mappings":"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","file":"site.js","sourcesContent":["window.JAY = {}\n\nJAY.immediate = ( function () {\n  'use strict'\n\n  const methods = {\n    init: function () {\n      document.querySelector('html').classList.add('js')\n    }\n  }\n\n  //  Public methods\n  return {\n    init: methods.init\n  }\n\n})(JAY)\n\nJAY.immediate.init()\n","JAY.global = ( function () {\n  'use strict'\n\n  const methods = {\n\n    init: function () {\n      let mobile = document.body.clientWidth < 768\n      if ( !mobile ) {\n        methods.fixedHeader()\n      }\n      methods.imageLoad(mobile)\n    },\n\n    fixedHeader: function () {\n      let body       = document.querySelector('body'),\n          bodyOffset = 0,\n          header     = document.querySelector('body > header')\n\n      window.addEventListener('scroll', () => {\n        // The second half of each of the following IF statements deals with Safari's bounceback when\n        // you scroll past the top of the page\n\n        // scroll down\n        if ( !body.classList.contains('hidden-header') && bodyOffset > body.getBoundingClientRect().top && Math.abs(body.getBoundingClientRect().top) > header.getBoundingClientRect().height ) {\n          body.classList.add('hidden-header')\n          body.classList.remove('fixed-header')\n        // scroll up\n        // The minus 10 pixels is to keep the header from popping in with only slight movements, which\n        // happens frequently when using touchscreens and touch input devices.\n        } else if ( !body.classList.contains('fixed-header') && body.getBoundingClientRect().top - 10 >= bodyOffset || Math.abs(body.getBoundingClientRect().top) <= header.getBoundingClientRect().height ) {\n          body.classList.remove('hidden-header')\n          if ( bodyOffset < -110 ) {\n            body.classList.add('fixed-header')\n          }\n        }\n        bodyOffset = body.getBoundingClientRect().top\n\n        if ( bodyOffset === 0 ) {\n          body.classList.remove('fixed-header')\n        }\n      }, { passive: true })\n    },\n\n    // Lazy load images\n    imageLoad: function (mobile) {\n      let images = document.querySelectorAll('img[data-src]:not(.loaded)')\n\n      const load = function () {\n        window.addEventListener('scroll', load, { capture: true, passive: true})\n        images.forEach( function (image) {\n          // If the image is within 2 viewport heights of the current offset, load it\n          if ( image.getBoundingClientRect().top < ( window.innerHeight * 2 ) ) {\n            image.src = image.dataset.src.replace('[parameters]', 'f_auto,q_80,' + ( image.clientHeight ? 'h_' + image.clientHeight : 'w_' + image.clientWidth ) + ',dpr_' + Math.ceil(window.devicePixelRatio) + '.0')\n            image.classList.add('loaded')\n            if ( !mobile && image.parentNode.tagName === 'A' && !image.parentNode.parentNode.classList.contains('devices') ) {\n              methods.imageZoom(image)\n            }\n            images = document.querySelectorAll('img[data-src]:not(.loaded)')\n            if ( !images.length ) {\n              window.removeEventListener('scroll', load, { capture: true, passive: true})\n            }\n          }\n        })\n      }\n\n      if ( images.length ) {\n        load()\n      }\n    },\n\n    imageZoom: function (image) {\n      let mask    = document.getElementById('mask') || document.createElement('div'),\n          anchor  = image.parentNode,\n          img     = document.createElement('img'),\n          src     = image.dataset.src.replace('[parameters]', 'f_auto,w_1500,q_80,dpr_' + Math.ceil(window.devicePixelRatio) + '.0'),\n          loading = function () {\n            // Add the loading spinner after a brief delay, otherwise it pops in and out and looks bad\n            setTimeout( function () {\n              if ( img.naturalWidth === 0 ) {\n                mask.classList.add('loading')\n\n                setTimeout( function () {\n                  mask.classList.remove('loading')\n                }, 10000)\n              }\n            }, 500)\n          }\n\n      mask.setAttribute('id', 'mask')\n      document.body.appendChild(mask)\n\n      anchor.addEventListener('click', function (e) {\n        e.preventDefault()\n        let figureGroup = image.parentNode.parentNode.parentNode.parentNode,\n            figureIndex = [...figureGroup.querySelector('section').children].indexOf(anchor.parentNode),\n            screenNav = false\n\n        mask.innerHTML = '<h1>Image 1 of 1</h1><a id=\"mask-open-tab\" href=\"' + src + '\" target=\"_blank\">Open this image in a new tab</a><a id=\"mask-close\" href=\"#\">Close</a>'\n\n        // Create navigation if it's a group of images\n        if ( figureGroup.getAttribute('role') === 'group' ) {\n          mask.querySelector('h1').innerHTML = 'Image <span class=\"current-image\">1</span> of <span class=\"total-images\">1</span>'\n          mask.innerHTML += '<nav id=\"screen-nav\"><ul></ul></nav>'\n          screenNav = mask.querySelector('#screen-nav')\n          figureGroup.querySelectorAll('figure').forEach( function (figure, index) {\n            screenNav.querySelector('ul').innerHTML += '<li' + ( index === figureIndex ? ' class=\"selected\"' : '' ) + '><a href=\"' + figure.querySelector('img').dataset.src.replace('[parameters]', 'f_auto,q_80,dpr_' + Math.ceil(window.devicePixelRatio) + '.0') + '\">' + figure.querySelector('img').getAttribute('alt') + '</a></li>'\n            mask.querySelector('span.current-image').innerHTML = figureIndex + 1\n            mask.querySelector('span.total-images').innerHTML = index + 1\n            screenNav.addEventListener('click', function (e) {\n              e.preventDefault()\n              if ( e.target.tagName === 'A' ) {\n                screenNav.querySelectorAll('li').forEach( function (anchor) {\n                  anchor.classList.remove('selected')\n                })\n                mask.querySelector('span.current-image').innerHTML = [...e.target.parentNode.parentNode.children].indexOf(e.target.parentNode) + 1\n                e.target.parentNode.classList.add('selected')\n                mask.querySelector('#mask-open-tab').setAttribute('href', e.target.href)\n                loading()\n                img.setAttribute('src', '/images/placeholder-zoom.svg')\n                img.setAttribute('src', e.target.href)\n              }\n            })\n          })\n        }\n\n        document.querySelector('html').classList.add('mask-enabled')\n        mask.classList.add('enabled')\n        img.setAttribute('src', src)\n        if ( screenNav ) {\n          mask.classList.add('screens')\n          mask.insertBefore(img, screenNav)\n        } else {\n          mask.append(img)\n        }\n        loading()\n\n        window.addEventListener('keydown', escape)\n        mask.querySelector('#mask-close').addEventListener('click', function (e) {\n          e.preventDefault()\n          close()\n        })\n\n        function escape(e) {\n          if ( e.key === 'Escape' ) {\n            close()\n          }\n        }\n\n        function close() {\n          document.querySelector('html').classList.remove('mask-enabled')\n          mask.classList.remove('enabled', 'loading', 'screens')\n          mask.innerHTML = ''\n          window.removeEventListener('keydown', escape)\n        }\n      })\n    }\n  }\n\n  //  Public methods\n  return {\n    init:       methods.init,\n    imageZoom:  methods.imageZoom\n  }\n\n}(JAY))\n","JAY.init = function () {\n  'use strict'\n\n  const body       = document.getElementsByTagName('body')[0],\n        controller = body.getAttribute('data-controller'),\n        action     = body.getAttribute('data-action'),\n        view       = body.getAttribute('data-view')\n\n  JAY.global.init()\n\n  if ( JAY[controller] ) {\n    JAY[controller].init()\n\n    if ( JAY[controller][action] && typeof JAY[controller][action] === 'function' ) {\n      JAY[controller][action]()\n\n      if ( JAY[controller][action][view] ) {\n        JAY[controller][action][view]()\n      }\n    }\n  }\n}\n\ndocument.onreadystatechange = function () {\n  'use strict'\n\n  if ( document.readyState === 'interactive' ) {\n    JAY.init()\n  }\n}\n"]}
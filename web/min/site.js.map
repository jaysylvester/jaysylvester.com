{"version":3,"sources":["immediate.js","case-study.js","global.js","init.js"],"names":["window","JAY","immediate","methods","init","document","querySelector","classList","add","detectTouchDevice","prefixes","split","DocumentTouch","query","join","matchMedia","matches","global","imageZoom","header","body","bodyOffset","setTimeout","addEventListener","contains","getBoundingClientRect","top","Math","abs","height","remove","clientWidth","mask","createElement","setAttribute","appendChild","querySelectorAll","forEach","item","zoomWrapper","zoomButton","parent","parentNode","src","getAttribute","insertBefore","innerHTML","escape","e","key","close","removeEventListener","menu","args","trigger","source","menuShadow","cloneNode","className","keepClass","position","removeChild","getElementsByTagName","controller","action","view","onreadystatechange","readyState"],"mappings":"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","file":"../js/site.js","sourcesContent":["window.JAY = {}\n\nJAY.immediate = ( function () {\n  'use strict'\n\n  var methods = {\n    init: function () {\n      document.querySelector('html').classList.add('js')\n      methods.detectTouchDevice()\n    },\n    \n    detectTouchDevice: function () {\n      // https://stackoverflow.com/questions/4817029/whats-the-best-way-to-detect-a-touch-screen-device-using-javascript#4819886\n      var prefixes = ' -webkit- -moz- -o- -ms- '.split(' ')\n      var mq = function(query) {\n        return window.matchMedia(query).matches\n      }\n    \n      if (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) {\n        return true\n      }\n    \n      // include the 'heartz' as a way to have a non matching MQ to help terminate the join\n      // https://git.io/vznFH\n      var query = ['(', prefixes.join('touch-enabled),('), 'heartz', ')'].join('')\n      return mq(query)\n    }\n  }\n\n  //  Public methods\n  return {\n    init: methods.init\n  }\n\n})(JAY)\n\nJAY.immediate.init()\n","JAY['case-study'] = ( function () {\n  'use strict'\n\n  var methods = {\n\n\t\tinit: function () {\n      JAY.global.imageZoom()\n    }\n\n  }\n\n\t//\tPublic methods\n\treturn {\n\t\tinit: methods.init\n\t}\n\n})(JAY)\n","JAY.global = ( function () {\n  'use strict'\n\n  var methods = {\n\n    init: function () {\n      methods.header()\n    },\n\n    header: function () {\n      var body = document.querySelector('body'),\n          bodyOffset = 0,\n          timer = 0,\n          header = document.querySelector('body > header'),\n          menuIcon\n\n      setTimeout( function () {\n        window.addEventListener('scroll', function () {\n          if ( !body.classList.contains('hidden-header') && bodyOffset > body.getBoundingClientRect().top && Math.abs(body.getBoundingClientRect().top) > header.getBoundingClientRect().height ) {\n            body.classList.add('hidden-header')\n          // The minus 10 pixels is to keep the header from popping in with only slight movements (happens frequently when using touchscreens and touch input devices)\n          // The second half of the statement deals with Safari's bounceback when you scroll past the top of the page\n          } else if ( body.getBoundingClientRect().top - 10 >= bodyOffset || Math.abs(body.getBoundingClientRect().top) <= header.getBoundingClientRect().height ) {\n            body.classList.remove('hidden-header')\n          }\n\n          bodyOffset = body.getBoundingClientRect().top\n        })\n      }, timer)\n      \n      // Create the main menu icon\n      // menuIcon = document.createElement('div')\n\n      // menuIcon.setAttribute('id', 'main-menu-icon')\n      // menuIcon.innerHTML = '<svg class=\"icon menu\"><use xlink:href=\"themes/default/images/symbols.svg#icon-menu\"></use></svg>'\n      // menuIcon.appendChild(document.createTextNode('Menu'))\n      // header.insertBefore(menuIcon, header.querySelector('a.home'))\n\n      // methods.menu({\n      //   menu: 'header nav',\n      //   trigger: '#main-menu-icon',\n      //   position: 'left'\n      // })\n    },\n\n    imageZoom: function () {\n      if ( document.body.clientWidth >= 768 ) {\n        var mask = document.createElement('div')\n        mask.setAttribute('id', 'mask')\n        document.body.appendChild(mask)\n\n        document.querySelectorAll('figure > img').forEach( function (item) {\n          var zoomWrapper = document.createElement('span'),\n              zoomButton = document.createElement('span'),\n              parent = item.parentNode,\n              src = item.getAttribute('src')\n          \n          zoomWrapper.classList.add('zoom')\n          parent.insertBefore(zoomWrapper, parent.querySelector('figcaption'))\n          zoomButton.classList.add('zoom-button')\n          zoomButton.innerHTML = '<svg class=\"icon zoom-in\"><use xlink:href=\"themes/default/images/symbols.svg#icon-zoom-in\"></use></svg>'\n          zoomWrapper.appendChild(item)\n          zoomWrapper.appendChild(zoomButton)\n\n          zoomWrapper.addEventListener('click', function () {\n            mask.innerHTML = '<div id=\"mask-close\"><svg class=\"icon close\"><use xlink:href=\"themes/default/images/symbols.svg#icon-close\"></use></svg></div><img src=\"' + src + '\"><a class=\"open-tab\" href=\"' + src + '\" target=\"_blank\">' + src + '<svg class=\"icon arrow-up-right\"><use xlink:href=\"themes/default/images/symbols.svg#icon-arrow-up-right\"></use></svg></a>'\n            document.querySelector('html').classList.add('mask-enabled')\n            mask.classList.add('enabled')\n\n            window.addEventListener('keydown', escape)\n            mask.querySelector('#mask-close').addEventListener('click', function () {\n              close()\n            })\n\n            function escape(e) {\n              if ( e.key === 'Escape' ) {\n                close()\n              }\n            }\n\n            function close() {\n              document.querySelector('html').classList.remove('mask-enabled')\n              mask.classList.remove('enabled')\n              mask.innerHTML = ''\n              window.removeEventListener('keydown', escape)\n            }\n          })\n        })\n      }\n    },\n\n    menu: function (args) {\n      var body = document.querySelector('body'),\n          menu,\n          trigger = document.querySelector(args.trigger)\n\n      trigger.addEventListener('click', function () {\n        var source = document.querySelector(args.menu),\n            menuShadow = document.createElement('div')\n\n        menu = source.cloneNode(true)\n        body.appendChild(menu)\n        menuShadow.className = 'menu-shadow'\n        body.appendChild(menuShadow)\n\n        if ( args.keepClass === false ) {\n          menu.className = 'slide-menu ' + args.position\n        } else {\n          menu.className += ' slide-menu ' + args.position\n        }\n\n        if ( body.classList.contains('menu-open') ) {\n          body.classList.remove('menu-open')\n          menu.classList.remove('open')\n          body.classList.add('menu-closing')\n          setTimeout( function () {\n            body.classList.remove('menu-closing')\n          }, 200)\n        } else {\n          body.classList.add('menu-opening')\n          setTimeout( function () {\n            body.classList.remove('menu-opening')\n            body.classList.add('menu-open')\n            menu.classList.add('open')\n          }, 200)\n        }\n\n        menuShadow.addEventListener('click', function () {\n          body.classList.remove('menu-open')\n          menu.classList.remove('open')\n          body.classList.add('menu-closing')\n          setTimeout( function () {\n            body.classList.remove('menu-closing')\n            body.removeChild(menuShadow)\n            if ( menu.parentNode !== null ) {\n              body.removeChild(menu)\n            }\n          }, 200)\n        }, false)\n      }, false)\n    },\n\n    // ajaxFormBinding: function(options) {\n    //   var form = document.querySelector(options.formSelector),\n    //       format = options.format || 'json',\n    //       type = options.type || 'direct'\n\n    //   form.addEventListener('submit', function (e) {\n    //     var request = new XMLHttpRequest(),\n    //         formData = new FormData(form),\n    //         data\n\n    //     e.preventDefault()\n\n    //     request.open('POST', form.action + '/format/' + format + '/type/' + type, true)\n    //     request.setRequestHeader('X-Requested-With', 'XMLHttpRequest')\n    //     // request.setRequestHeader('Content-Type', 'application/json')\n    //     request.send(formData)\n\n    //     request.onreadystatechange = function () {\n    //       console.log('readyState: ' + request.readyState)\n    //       console.log('status: ' + request.status)\n    //     }\n\n    //     request.onload = function () {\n    //       if ( request.status >= 200 && request.status < 400 ) {\n    //         data = JSON.parse(request.responseText)\n    //         console.log(data)\n    //       } else {\n    //         // We reached our target server, but it returned an error\n    //       }\n    //     }\n\n    //     request.onerror = function () {\n    //       // There was a connection error of some sort\n    //     }\n    //   })\n\n    //   // Some browsers don't include the submit button's value when form.submit() is\n    //   // called. This function creates a click listener that duplicates a form's submit\n    //   // button as a hidden field so its name/value can be included in AJAX POSTs,\n    //   // allowing different processing based on different submit buttons.\n    //   form.addEventListener('click', function (e) {\n    //     var input = document.createElement('input'),\n    //         previousActions = form.querySelectorAll('input[type=\"hidden\"].submit-surrogate')\n\n    //     for ( var i = 0; i < previousActions.length; i++ ) {\n    //       form.removeChild(previousActions[i])\n    //     }\n\n    //     if ( e.target.type && e.target.type.toLowerCase() === 'submit' ) {\n    //       input.name = e.target.name\n    //       input.type = 'hidden'\n    //       input.value = e.target.value\n    //       input.className = 'submit-surrogate'\n\n    //       form.appendChild(input)\n    //     }\n    //   })\n    // }\n  }\n\n  //  Public methods\n  return {\n    // ajaxFormBinding: methods.ajaxFormBinding,\n    init:       methods.init,\n    imageZoom:  methods.imageZoom,\n    menu:       methods.menu\n  }\n\n}(JAY))\n","JAY.init = function () {\n  'use strict'\n\n  var body = document.getElementsByTagName('body')[0],\n      controller = body.getAttribute('data-controller'),\n      action = body.getAttribute('data-action'),\n      view = body.getAttribute('data-view')\n\n  JAY.global.init()\n\n  if ( JAY[controller] ) {\n    JAY[controller].init()\n\n    if ( JAY[controller][action] && typeof JAY[controller][action] === 'function' ) {\n      JAY[controller][action]()\n\n      if ( JAY[controller][action][view] ) {\n        JAY[controller][action][view]()\n      }\n    }\n  }\n}\n\ndocument.onreadystatechange = function () {\n  'use strict'\n\n  if ( document.readyState === 'interactive' ) {\n    JAY.init()\n  }\n}\n"]}
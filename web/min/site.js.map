{"version":3,"sources":["immediate.js","global.js","init.js"],"names":["window","JAY","immediate","init","document","querySelector","classList","add","global","methods","header","imageLoad","body","bodyOffset","setTimeout","addEventListener","contains","getBoundingClientRect","top","Math","abs","height","remove","load","images","querySelectorAll","length","forEach","item","dimension","clientWidth","clientHeight","src","dataset","replace","ceil","devicePixelRatio","parentNode","tagName","imageZoom","removeEventListener","mask","getElementById","createElement","anchor","setAttribute","appendChild","e","escape","key","close","innerHTML","preventDefault","menu","args","trigger","source","menuShadow","cloneNode","className","keepClass","position","removeChild","getElementsByTagName","controller","getAttribute","action","view","onreadystatechange","readyState"],"mappings":"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","file":"../js/site.js","sourcesContent":["window.JAY = {}\n\nJAY.immediate = ( function () {\n  'use strict'\n\n  var methods = {\n    init: function () {\n      document.querySelector('html').classList.add('js')\n    }\n  }\n\n  //  Public methods\n  return {\n    init: methods.init\n  }\n\n})(JAY)\n\nJAY.immediate.init()\n","JAY.global = ( function () {\n  'use strict'\n\n  var methods = {\n\n    init: function () {\n      methods.header()\n      methods.imageLoad()\n    },\n\n    header: function () {\n      var body = document.querySelector('body'),\n          bodyOffset = 0,\n          timer = 0,\n          header = document.querySelector('body > header')\n\n      setTimeout( function () {\n        window.addEventListener('scroll', function () {\n          if ( !body.classList.contains('hidden-header') && bodyOffset > body.getBoundingClientRect().top && Math.abs(body.getBoundingClientRect().top) > header.getBoundingClientRect().height ) {\n            body.classList.add('hidden-header')\n          // The minus 10 pixels is to keep the header from popping in with only slight movements (happens frequently when using touchscreens and touch input devices)\n          // The second half of the statement deals with Safari's bounceback when you scroll past the top of the page\n          } else if ( body.getBoundingClientRect().top - 10 >= bodyOffset || Math.abs(body.getBoundingClientRect().top) <= header.getBoundingClientRect().height ) {\n            body.classList.remove('hidden-header')\n          }\n\n          bodyOffset = body.getBoundingClientRect().top\n        })\n      }, timer)\n      \n      // Create the main menu icon\n      // menuIcon = document.createElement('div')\n\n      // menuIcon.setAttribute('id', 'main-menu-icon')\n      // menuIcon.innerHTML = '<svg class=\"icon menu\"><use xlink:href=\"themes/default/images/symbols.svg#icon-menu\"></use></svg>'\n      // menuIcon.appendChild(document.createTextNode('Menu'))\n      // header.insertBefore(menuIcon, header.querySelector('a.home'))\n\n      // methods.menu({\n      //   menu: 'header nav',\n      //   trigger: '#main-menu-icon',\n      //   position: 'left'\n      // })\n    },\n\n    imageLoad: function () {\n      var load = function () {\n            const images = document.querySelectorAll('img[data-src]:not(.loaded)')\n            \n            if ( images.length ) {\n              images.forEach( function (item) {\n                // Make sure all images have an explicit width or height set in CSS for best results\n                let dimension\n                // Default to width on mobile since most images are set to 100% width\n                if ( document.body.clientWidth < 768 ) {\n                  dimension = item.clientWidth ? 'w_' + item.clientWidth : 'h_' + item.clientHeight\n                // Default to height on larger devices\n                } else {\n                  dimension = item.clientHeight ? 'h_' + item.clientHeight : 'w_' + item.clientWidth\n                }\n\n                // If the image is within 2 screen heights of the current offset, load it\n                if ( item.getBoundingClientRect().top < ( document.body.clientHeight * 2 ) ) {\n                  item.src = item.dataset.src.replace('[parameters]', 'f_auto,q_80,' + dimension + ',dpr_' + Math.ceil(window.devicePixelRatio) + '.0')\n                  item.classList.add('loaded')\n                  if ( item.parentNode.parentNode.tagName === 'FIGURE' ) {\n                    methods.imageZoom(item)\n                  }\n                }\n              })\n            } else {\n              window.removeEventListener('scroll', load)\n            }\n          }\n      \n      load()\n\n      window.addEventListener('scroll', load)\n    },\n\n    imageZoom: function (item) {\n      var mask = document.getElementById('mask') || document.createElement('div'),\n          anchor = item.parentNode,\n          src = item.dataset.src.replace('[parameters]', 'f_auto,q_80,dpr_' + Math.ceil(window.devicePixelRatio) + '.0')\n\n      mask.setAttribute('id', 'mask')\n      document.body.appendChild(mask)\n\n      anchor.addEventListener('click', function (e) {\n        e.preventDefault()\n        mask.innerHTML = '<a id=\"mask-open-tab\" href=\"' + src + '\" target=\"_blank\">Open this image in a new tab</a><a id=\"mask-close\" href=\"#\">Close</a><img src=\"' + src + '\">'\n        document.querySelector('html').classList.add('mask-enabled')\n        mask.classList.add('enabled')\n\n        window.addEventListener('keydown', escape)\n        mask.querySelector('#mask-close').addEventListener('click', function (e) {\n          e.preventDefault()\n          close()\n        })\n        mask.querySelector('#mask-open-tab').addEventListener('click', function () {\n          close()\n        })\n\n        function escape(e) {\n          if ( e.key === 'Escape' ) {\n            close()\n          }\n        }\n\n        function close() {\n          document.querySelector('html').classList.remove('mask-enabled')\n          mask.classList.remove('enabled')\n          mask.innerHTML = ''\n          window.removeEventListener('keydown', escape)\n        }\n      })\n    },\n\n    menu: function (args) {\n      var body = document.querySelector('body'),\n          menu,\n          trigger = document.querySelector(args.trigger)\n\n      trigger.addEventListener('click', function () {\n        var source = document.querySelector(args.menu),\n            menuShadow = document.createElement('div')\n\n        menu = source.cloneNode(true)\n        body.appendChild(menu)\n        menuShadow.className = 'menu-shadow'\n        body.appendChild(menuShadow)\n\n        if ( args.keepClass === false ) {\n          menu.className = 'slide-menu ' + args.position\n        } else {\n          menu.className += ' slide-menu ' + args.position\n        }\n\n        if ( body.classList.contains('menu-open') ) {\n          body.classList.remove('menu-open')\n          menu.classList.remove('open')\n          body.classList.add('menu-closing')\n          setTimeout( function () {\n            body.classList.remove('menu-closing')\n          }, 200)\n        } else {\n          body.classList.add('menu-opening')\n          setTimeout( function () {\n            body.classList.remove('menu-opening')\n            body.classList.add('menu-open')\n            menu.classList.add('open')\n          }, 200)\n        }\n\n        menuShadow.addEventListener('click', function () {\n          body.classList.remove('menu-open')\n          menu.classList.remove('open')\n          body.classList.add('menu-closing')\n          setTimeout( function () {\n            body.classList.remove('menu-closing')\n            body.removeChild(menuShadow)\n            if ( menu.parentNode !== null ) {\n              body.removeChild(menu)\n            }\n          }, 200)\n        }, false)\n      }, false)\n    },\n\n    // ajaxFormBinding: function(options) {\n    //   var form = document.querySelector(options.formSelector),\n    //       format = options.format || 'json',\n    //       type = options.type || 'direct'\n\n    //   form.addEventListener('submit', function (e) {\n    //     var request = new XMLHttpRequest(),\n    //         formData = new FormData(form),\n    //         data\n\n    //     e.preventDefault()\n\n    //     request.open('POST', form.action + '/format/' + format + '/type/' + type, true)\n    //     request.setRequestHeader('X-Requested-With', 'XMLHttpRequest')\n    //     // request.setRequestHeader('Content-Type', 'application/json')\n    //     request.send(formData)\n\n    //     request.onreadystatechange = function () {\n    //       console.log('readyState: ' + request.readyState)\n    //       console.log('status: ' + request.status)\n    //     }\n\n    //     request.onload = function () {\n    //       if ( request.status >= 200 && request.status < 400 ) {\n    //         data = JSON.parse(request.responseText)\n    //         console.log(data)\n    //       } else {\n    //         // We reached our target server, but it returned an error\n    //       }\n    //     }\n\n    //     request.onerror = function () {\n    //       // There was a connection error of some sort\n    //     }\n    //   })\n\n    //   // Some browsers don't include the submit button's value when form.submit() is\n    //   // called. This function creates a click listener that duplicates a form's submit\n    //   // button as a hidden field so its name/value can be included in AJAX POSTs,\n    //   // allowing different processing based on different submit buttons.\n    //   form.addEventListener('click', function (e) {\n    //     var input = document.createElement('input'),\n    //         previousActions = form.querySelectorAll('input[type=\"hidden\"].submit-surrogate')\n\n    //     for ( var i = 0; i < previousActions.length; i++ ) {\n    //       form.removeChild(previousActions[i])\n    //     }\n\n    //     if ( e.target.type && e.target.type.toLowerCase() === 'submit' ) {\n    //       input.name = e.target.name\n    //       input.type = 'hidden'\n    //       input.value = e.target.value\n    //       input.className = 'submit-surrogate'\n\n    //       form.appendChild(input)\n    //     }\n    //   })\n    // }\n  }\n\n  //  Public methods\n  return {\n    // ajaxFormBinding: methods.ajaxFormBinding,\n    init:       methods.init,\n    imageZoom:  methods.imageZoom,\n    menu:       methods.menu\n  }\n\n}(JAY))\n","JAY.init = function () {\n  'use strict'\n\n  var body        = document.getElementsByTagName('body')[0],\n      controller  = body.getAttribute('data-controller'),\n      action      = body.getAttribute('data-action'),\n      view        = body.getAttribute('data-view')\n\n  JAY.global.init()\n\n  if ( JAY[controller] ) {\n    JAY[controller].init()\n\n    if ( JAY[controller][action] && typeof JAY[controller][action] === 'function' ) {\n      JAY[controller][action]()\n\n      if ( JAY[controller][action][view] ) {\n        JAY[controller][action][view]()\n      }\n    }\n  }\n}\n\ndocument.onreadystatechange = function () {\n  'use strict'\n\n  if ( document.readyState === 'interactive' ) {\n    JAY.init()\n  }\n}\n"]}